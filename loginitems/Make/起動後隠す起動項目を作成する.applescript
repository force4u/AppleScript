<hr><p class="openscript"><a href="applescript://com.apple.scripteditor?action=new&name=com.cocolog-nifty.quicktimer&script=%23!/usr/bin/env%20osascript%0A----%2B----1----%2B----2----%2B-----3----%2B----4----%2B----5----%2B----6----%2B----7%0A%23%0A%23%0A%23%20com.cocolog-nifty.quicktimer.icefloe%0A----%2B----1----%2B----2----%2B-----3----%2B----4----%2B----5----%2B----6----%2B----7%0A%23%23%E8%87%AA%E5%88%86%E7%92%B0%E5%A2%83%E3%81%8Cos12%E3%81%AA%E3%81%AE%E3%81%A72.8%E3%81%AB%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E3%81%A0%E3%81%91%E3%81%A7%E3%81%99%0Ause%20AppleScript%20version%20%222.8%22%0Ause%20framework%20%22Foundation%22%0Ause%20framework%20%22Appkit%22%0Ause%20framework%20%22UniformTypeIdentifiers%22%0Ause%20scripting%20additions%0Aproperty%20refMe%20:%20a%20reference%20to%20current%20application%0A%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%23%23%E8%A8%AD%E5%AE%9A%E9%A0%85%E7%9B%AE%0A%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%23%23%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E5%90%8D%0Aset%20strDirName%20to%20(%22Loginitems%22)%20as%20text%0A%23%23%23%E3%82%AA%E3%83%BC%E3%83%AB%E3%83%89%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%AF%E3%81%93%E3%81%A1%E3%82%89%E3%81%8B%E3%81%AA%EF%BC%9F%0A%23%09set%20strDirName%20to%20(%22StartupItems%22)%20as%20text%0A%23%23%23%E8%B5%B7%E5%8B%95%E9%A0%85%E7%9B%AE%E3%81%AE%E3%83%90%E3%83%B3%E3%83%89%E3%83%ABID%0Aset%20strBundleID%20to%20(%22com.apple.FontBook%22)%20as%20text%0Aset%20strAppFileName%20to%20(strBundleID%20%26%20%22.app%22)%20as%20text%0A%23%23%23%E8%B5%B7%E5%8B%95%E9%A0%85%E7%9B%AEAPP%E3%81%AB%E9%9A%A0%E3%81%99%E3%82%92%E5%85%A5%E3%82%8C%E3%82%8B%E3%81%8B%EF%BC%9F%0Aset%20boolSetHide%20to%20true%20as%20boolean%0A%0A%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%23%23%23%23%23%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%83%A1%E3%83%8B%E3%83%A5%E3%83%BC%E3%81%8B%E3%82%89%E5%AE%9F%E8%A1%8C%E3%81%95%E3%81%9B%E3%81%AA%E3%81%84%0A%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0Atell%20current%20application%0A%09set%20strName%20to%20name%20as%20text%0Aend%20tell%0A%23%23%23%23%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%83%A1%E3%83%8B%E3%83%A5%E3%83%BC%E3%81%8B%E3%82%89%E5%AE%9F%E8%A1%8C%E3%81%97%E3%81%9F%E3%82%89%0Aif%20strName%20is%20%22osascript%22%20then%0A%09tell%20application%20%22Finder%22%0A%09%09set%20aliasPathToMe%20to%20path%20to%20me%20as%20alias%0A%09%09tell%20application%20%22Script%20Editor%22%0A%09%09%09open%20aliasPathToMe%0A%09%09end%20tell%0A%09%09return%20%22%E4%B8%AD%E6%AD%A2%E3%81%97%E3%81%BE%E3%81%97%E3%81%9F%22%0A%09end%20tell%0Aelse%0A%09tell%20current%20application%0A%09%09activate%0A%09end%20tell%0Aend%20if%0A%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%23%23%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%EF%BC%88%E8%B5%B7%E5%8B%95%E9%A0%85%E7%9B%AE%E7%94%A8%EF%BC%89%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B%0A%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%0A%23%23%23%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%83%91%E3%82%B9%0Aset%20appFileManager%20to%20refMe's%20NSFileManager's%20defaultManager()%0Aset%20ocidURLsArray%20to%20(appFileManager's%20URLsForDirectory:(refMe's%20NSLibraryDirectory)%20inDomains:(refMe's%20NSUserDomainMask))%0Aset%20ocidLibraryDirPathURL%20to%20ocidURLsArray's%20firstObject()%0A%23%23%23Loginitems%0Aset%20ocidLoginitemsDirPathURL%20to%20ocidLibraryDirPathURL's%20URLByAppendingPathComponent:(%22Loginitems%22)%0A%23%23%23%E3%83%95%E3%82%A9%E3%83%AB%E3%83%80%E3%82%92%E4%BD%9C%E3%82%8B%0Aset%20ocidAttrDict%20to%20refMe's%20NSMutableDictionary's%20alloc()'s%20initWithCapacity:0%0AocidAttrDict's%20setValue:(448)%20forKey:(refMe's%20NSFilePosixPermissions)%0Aset%20listBoolMakeDir%20to%20appFileManager's%20createDirectoryAtURL:(ocidLoginitemsDirPathURL)%20withIntermediateDirectories:true%20attributes:(ocidAttrDict)%20%7Cerror%7C:(reference)%0A%23%23%23%E4%BF%9D%E5%AD%98%E5%85%88%0Aset%20ocidLoginitemsAppPathURL%20to%20ocidLoginitemsDirPathURL's%20URLByAppendingPathComponent:(strAppFileName)%0Aset%20aliasAppFilePath%20to%20(ocidLoginitemsAppPathURL's%20absoluteURL())%20as%20%C2%ABclass%20furl%C2%BB%0A%0A%0A%0Aset%20strScript%20to%20(%22%23!/usr/bin/env%20osascript%5Cn----%2B----1----%2B----2----%2B-----3----%2B----4----%2B----5----%2B----6----%2B----7%5Cn%23%5Cn(*%5Cn%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E9%A0%85%E7%9B%AE%E7%99%BB%E9%8C%B2%E7%94%A8%5Cn%E8%B5%B7%E5%8B%95%E6%99%82%E3%81%AB%E8%B5%B7%E5%8B%95%E5%BE%8C%E3%80%8E%E9%9A%A0%E3%81%99%E3%80%8F%E5%87%A6%E7%90%86%5Cn%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%EF%BC%9E%E6%9B%B8%E3%81%8D%E5%87%BA%E3%81%99%E2%80%A6%E3%81%8B%E3%82%89%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AB%E6%9B%B8%E3%81%8D%E5%87%BA%E3%81%97%5Cn%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E9%A0%85%E7%9B%AE%E3%81%AB%E7%99%BB%E9%8C%B2%E3%81%99%E3%82%8B%5Cn%E8%A8%AD%E5%AE%9A%E9%A0%85%E7%9B%AE%E3%81%AE%E3%83%90%E3%83%B3%E3%83%89%E3%83%ABID%E3%81%AF%5Cnhttps://github.com/force4u/AppleScript/blob/main/Script%2520Menu/Developer/Get/getAppBundleID.applescript%5Cn%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E5%8F%96%E5%BE%97%E3%81%A7%E3%81%8D%E3%81%BE%E3%81%99%5Cn*)%5Cn%23com.cocolog-nifty.quicktimer.icefloe%5Cn----%2B----1----%2B----2----%2B-----3----%2B----4----%2B----5----%2B----6----%2B----7%5Cnuse%20AppleScript%20version%20%5C%222.8%5C%22%5Cnuse%20framework%20%5C%22Foundation%5C%22%5Cnuse%20scripting%20additions%5Cn%23%23%23%E8%A8%AD%E5%AE%9A%E9%A0%85%E7%9B%AE%5Cnset%20strBundleID%20to%20(%5C%22%22%20%26%20strBundleID%20%26%20%22%5C%22)%20as%20text%5Cn%23%23%23%E8%B5%B7%E5%8B%95%5Cntell%20application%20id%20strBundleID%5Cnlaunch%5Cnend%20tell%5Cndelay%203%5Cn%23%23%23%E8%B5%B7%E5%8B%95%E5%BE%85%E3%81%A1%E3%80%80%E6%9C%80%E5%A4%A7%EF%BC%96%EF%BC%90%E5%9B%9E%5Cnrepeat%2060%20times%5Cntell%20application%20id%20strBundleID%5Cnactivate%5Cnset%20boolFrontMost%20to%20frontmost%20as%20boolean%5Cnend%20tell%5Cnif%20boolFrontMost%20is%20true%20then%5Cnexit%20repeat%5Cnelse%5Cndelay%200.25%5Cnend%20if%5Cnend%20repeat%5Cn%23%23%23%E5%90%8D%E5%89%8D%E3%81%AE%E5%8F%96%E5%BE%97%5Cntell%20application%20id%20strBundleID%5Cnset%20strAppName%20to%20name%20as%20text%5Cnend%20tell%5Cn%23%23%23%E9%9A%A0%E3%81%99%E5%87%A6%E7%90%86%5Cntell%20application%20%5C%22System%20Events%5C%22%5Cntell%20application%20process%20strAppName%5Cnset%20visible%20to%20false%5Cnend%20tell%5Cnend%20tell%22)%20as%20text%0A%0A%0Atell%20application%20%22Script%20Editor%22%0A%09%0A%09make%20new%20document%20with%20properties%20%7Bcontents:strScript%7D%0A%09tell%20front%20document%0A%09%09activate%0A%09%09compile%0A%09end%20tell%0A%09save%20front%20document%20as%20%22application%22%20in%20aliasAppFilePath%20without%20run%20only,%20startup%20screen%20and%20stay%20open%0A%09close%20front%20document%20saving%20no%0Aend%20tell%0A%0A%0A%0A%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%23%23%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%EF%BC%88%E8%B5%B7%E5%8B%95%E9%A0%85%E7%9B%AE%E7%94%A8%EF%BC%89%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B%0A%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%0A%23%23%23%E3%83%90%E3%83%B3%E3%83%89%E3%83%AB%0Aset%20ocidAppBundle%20to%20refMe's%20NSBundle's%20bundleWithURL:(ocidLoginitemsAppPathURL)%0A%23%23%23%E5%9F%BA%E6%9C%AC%E6%83%85%E5%A0%B1%E3%82%92%E5%8F%96%E5%BE%97%0Aset%20ocidInfoDict%20to%20ocidAppBundle's%20infoDictionary%0Aset%20ocidBundleName%20to%20ocidInfoDict's%20valueForKey:(%22CFBundleName%22)%0Aset%20ocidBundleDisplayName%20to%20ocidInfoDict's%20valueForKey:(%22CFBundleDisplayName%22)%0A%23%23%23%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%A9%E3%82%A4%E3%82%BA%E5%90%8D%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B%0Aset%20ocidBundleDisplayNameLocalizable%20to%20ocidAppBundle's%20localizedStringForKey:(%22CFBundleDisplayName%22)%20value:(%22%22)%20table:(%22InfoPlist%22)%0Aif%20(ocidBundleDisplayNameLocalizable%20as%20text)%20is%20%22CFBundleDisplayName%22%20then%0A%09set%20ocidBundleDisplayNameLocalizable%20to%20ocidBundleDisplayName%0Aend%20if%0Aif%20(ocidBundleDisplayNameLocalizable%20as%20text)%20is%20%22%22%20then%0A%09set%20ocidBundleDisplayNameLocalizable%20to%20ocidBundleName%0Aend%20if%0A%0Aset%20strAppName%20to%20ocidBundleDisplayNameLocalizable%20as%20text%0Aset%20strAppPath%20to%20(ocidLoginitemsAppPathURL's%20%7Cpath%7C())%20as%20text%0Alog%20%22strAppName:%22%20%26%20strAppName%0A%0Atell%20application%20%22System%20Events%22%0A%09if%20boolSetHide%20is%20true%20then%0A%09%09set%20recordProperties%20to%20%7Bname:strAppName,%20path:strAppPath,%20class:login%20item,%20kind:%22%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%22,%20hidden:true%7D%0A%09else%0A%09%09set%20recordProperties%20to%20%7Bname:strAppName,%20path:strAppPath,%20class:login%20item,%20kind:%22%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%22,%20hidden:false%7D%0A%09end%20if%0Aend%20tell%0A%0A%23%23%23%23%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E3%82%A2%E3%82%A4%E3%83%86%E3%83%A0%20%E8%A8%AD%E5%AE%9A%E9%96%8B%E5%A7%8B%E6%99%82%0Alog%20%22%E8%A8%AD%E5%AE%9A%E5%89%8D%EF%BC%9A%22%0Atell%20application%20%22System%20Events%22%0A%09set%20listLoginItem%20to%20every%20login%20item%0A%09set%20listOutPut%20to%20%7B%7D%20as%20list%0A%09repeat%20with%20itemLoginItem%20in%20listLoginItem%0A%09%09tell%20itemLoginItem%0A%09%09%09set%20recordProperties%20to%20properties%0A%09%09%09set%20end%20of%20listOutPut%20to%20recordProperties%0A%09%09end%20tell%0A%09end%20repeat%0Aend%20tell%0A%0A%23%23%23%23%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E3%82%A2%E3%82%A4%E3%83%86%E3%83%A0%20%E8%A8%AD%E5%AE%9A%0Alog%20%22%E8%A8%AD%E5%AE%9A%EF%BC%9A%22%0Atell%20application%20%22System%20Events%22%0A%09make%20login%20item%20at%20end%20with%20properties%20recordProperties%0Aend%20tell%0A%0A%0A%23%23%23%23%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E3%82%A2%E3%82%A4%E3%83%86%E3%83%A0%20%E8%A8%AD%E5%AE%9A%E5%BE%8C%0Alog%20%22%E8%A8%AD%E5%AE%9A%E5%BE%8C%EF%BC%9A%22%0Atell%20application%20%22System%20Events%22%0A%09set%20listLoginItem%20to%20every%20login%20item%0A%09set%20listOutPut%20to%20%7B%7D%20as%20list%0A%09repeat%20with%20itemLoginItem%20in%20listLoginItem%0A%09%09tell%20itemLoginItem%0A%09%09%09set%20recordProperties%20to%20properties%0A%09%09%09set%20end%20of%20listOutPut%20to%20recordProperties%0A%09%09end%20tell%0A%09end%20repeat%0Aend%20tell%0A%0A%23%23%23%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E9%A0%85%E7%9B%AE%E3%82%92%E9%96%8B%E3%81%8F%0Atell%20application%20id%20%22com.apple.systempreferences%22%0A%09launch%0A%09activate%0A%09reveal%20anchor%20%22startupItemsPref%22%20of%20pane%20id%20%22com.apple.LoginItems-Settings.extension%22%0Aend%20tell" title="Open in Script Edito">【スクリプトエディタで開く】</a>| <textarea id="inputText617" type="text" hidden readonly>#!/usr/bin/env osascript
----&#x2B;----1----&#x2B;----2----&#x2B;-----3----&#x2B;----4----&#x2B;----5----&#x2B;----6----&#x2B;----7
#
#
# com.cocolog-nifty.quicktimer.icefloe
----&#x2B;----1----&#x2B;----2----&#x2B;-----3----&#x2B;----4----&#x2B;----5----&#x2B;----6----&#x2B;----7
##自分環境がos12なので2.8にしているだけです
use AppleScript version &quot;2.8&quot;
use framework &quot;Foundation&quot;
use framework &quot;Appkit&quot;
use framework &quot;UniformTypeIdentifiers&quot;
use scripting additions
property refMe : a reference to current application
##############################################
##設定項目
##############################################
##ディレクトリ名
set strDirName to (&quot;Loginitems&quot;) as text
###オールドユーザーはこちらかな？
#	set strDirName to (&quot;StartupItems&quot;) as text
###起動項目のバンドルID
set strBundleID to (&quot;com.apple.FontBook&quot;) as text
set strAppFileName to (strBundleID &amp; &quot;.app&quot;) as text
###起動項目APPに隠すを入れるか？
set boolSetHide to true as boolean

#####################################
#####スクリプトメニューから実行させない
#####################################
tell current application
	set strName to name as text
end tell
####スクリプトメニューから実行したら
if strName is &quot;osascript&quot; then
	tell application &quot;Finder&quot;
		set aliasPathToMe to path to me as alias
		tell application &quot;Script Editor&quot;
			open aliasPathToMe
		end tell
		return &quot;中止しました&quot;
	end tell
else
	tell current application
		activate
	end tell
end if
#####################################
##アプリケーション（起動項目用）を作成する
#####################################

###スクリプトパス
set appFileManager to refMe&apos;s NSFileManager&apos;s defaultManager()
set ocidURLsArray to (appFileManager&apos;s URLsForDirectory:(refMe&apos;s NSLibraryDirectory) inDomains:(refMe&apos;s NSUserDomainMask))
set ocidLibraryDirPathURL to ocidURLsArray&apos;s firstObject()
###Loginitems
set ocidLoginitemsDirPathURL to ocidLibraryDirPathURL&apos;s URLByAppendingPathComponent:(&quot;Loginitems&quot;)
###フォルダを作る
set ocidAttrDict to refMe&apos;s NSMutableDictionary&apos;s alloc()&apos;s initWithCapacity:0
ocidAttrDict&apos;s setValue:(448) forKey:(refMe&apos;s NSFilePosixPermissions)
set listBoolMakeDir to appFileManager&apos;s createDirectoryAtURL:(ocidLoginitemsDirPathURL) withIntermediateDirectories:true attributes:(ocidAttrDict) |error|:(reference)
###保存先
set ocidLoginitemsAppPathURL to ocidLoginitemsDirPathURL&apos;s URLByAppendingPathComponent:(strAppFileName)
set aliasAppFilePath to (ocidLoginitemsAppPathURL&apos;s absoluteURL()) as «class furl»



set strScript to (&quot;#!/usr/bin/env osascript&bsol;n----&#x2B;----1----&#x2B;----2----&#x2B;-----3----&#x2B;----4----&#x2B;----5----&#x2B;----6----&#x2B;----7&bsol;n#&bsol;n(*&bsol;nログイン項目登録用&bsol;n起動時に起動後『隠す』処理&bsol;nファイル＞書き出す…からアプリケーションに書き出し&bsol;nログイン項目に登録する&bsol;n設定項目のバンドルIDは&bsol;nhttps://github.com/force4u/AppleScript/blob/main/Script%20Menu/Developer/Get/getAppBundleID.applescript&bsol;nを使って取得できます&bsol;n*)&bsol;n#com.cocolog-nifty.quicktimer.icefloe&bsol;n----&#x2B;----1----&#x2B;----2----&#x2B;-----3----&#x2B;----4----&#x2B;----5----&#x2B;----6----&#x2B;----7&bsol;nuse AppleScript version &bsol;&quot;2.8&bsol;&quot;&bsol;nuse framework &bsol;&quot;Foundation&bsol;&quot;&bsol;nuse scripting additions&bsol;n###設定項目&bsol;nset strBundleID to (&bsol;&quot;&quot; &amp; strBundleID &amp; &quot;&bsol;&quot;) as text&bsol;n###起動&bsol;ntell application id strBundleID&bsol;nlaunch&bsol;nend tell&bsol;ndelay 3&bsol;n###起動待ち　最大６０回&bsol;nrepeat 60 times&bsol;ntell application id strBundleID&bsol;nactivate&bsol;nset boolFrontMost to frontmost as boolean&bsol;nend tell&bsol;nif boolFrontMost is true then&bsol;nexit repeat&bsol;nelse&bsol;ndelay 0.25&bsol;nend if&bsol;nend repeat&bsol;n###名前の取得&bsol;ntell application id strBundleID&bsol;nset strAppName to name as text&bsol;nend tell&bsol;n###隠す処理&bsol;ntell application &bsol;&quot;System Events&bsol;&quot;&bsol;ntell application process strAppName&bsol;nset visible to false&bsol;nend tell&bsol;nend tell&quot;) as text


tell application &quot;Script Editor&quot;
	
	make new document with properties {contents:strScript}
	tell front document
		activate
		compile
	end tell
	save front document as &quot;application&quot; in aliasAppFilePath without run only, startup screen and stay open
	close front document saving no
end tell



#####################################
##アプリケーション（起動項目用）を作成する
#####################################

###バンドル
set ocidAppBundle to refMe&apos;s NSBundle&apos;s bundleWithURL:(ocidLoginitemsAppPathURL)
###基本情報を取得
set ocidInfoDict to ocidAppBundle&apos;s infoDictionary
set ocidBundleName to ocidInfoDict&apos;s valueForKey:(&quot;CFBundleName&quot;)
set ocidBundleDisplayName to ocidInfoDict&apos;s valueForKey:(&quot;CFBundleDisplayName&quot;)
###ローカライズ名を取得する
set ocidBundleDisplayNameLocalizable to ocidAppBundle&apos;s localizedStringForKey:(&quot;CFBundleDisplayName&quot;) value:(&quot;&quot;) table:(&quot;InfoPlist&quot;)
if (ocidBundleDisplayNameLocalizable as text) is &quot;CFBundleDisplayName&quot; then
	set ocidBundleDisplayNameLocalizable to ocidBundleDisplayName
end if
if (ocidBundleDisplayNameLocalizable as text) is &quot;&quot; then
	set ocidBundleDisplayNameLocalizable to ocidBundleName
end if

set strAppName to ocidBundleDisplayNameLocalizable as text
set strAppPath to (ocidLoginitemsAppPathURL&apos;s |path|()) as text
log &quot;strAppName:&quot; &amp; strAppName

tell application &quot;System Events&quot;
	if boolSetHide is true then
		set recordProperties to {name:strAppName, path:strAppPath, class:login item, kind:&quot;アプリケーション&quot;, hidden:true}
	else
		set recordProperties to {name:strAppName, path:strAppPath, class:login item, kind:&quot;アプリケーション&quot;, hidden:false}
	end if
end tell

####ログインアイテム 設定開始時
log &quot;設定前：&quot;
tell application &quot;System Events&quot;
	set listLoginItem to every login item
	set listOutPut to {} as list
	repeat with itemLoginItem in listLoginItem
		tell itemLoginItem
			set recordProperties to properties
			set end of listOutPut to recordProperties
		end tell
	end repeat
end tell

####ログインアイテム 設定
log &quot;設定：&quot;
tell application &quot;System Events&quot;
	make login item at end with properties recordProperties
end tell


####ログインアイテム 設定後
log &quot;設定後：&quot;
tell application &quot;System Events&quot;
	set listLoginItem to every login item
	set listOutPut to {} as list
	repeat with itemLoginItem in listLoginItem
		tell itemLoginItem
			set recordProperties to properties
			set end of listOutPut to recordProperties
		end tell
	end repeat
end tell

###ログイン項目を開く
tell application id &quot;com.apple.systempreferences&quot;
	launch
	activate
	reveal anchor &quot;startupItemsPref&quot; of pane id &quot;com.apple.LoginItems-Settings.extension&quot;
end tell</textarea><button id="buttonCopy617">クリップボードへコピー</button><script>const elmentButtonCopy617 = document.getElementById('buttonCopy617');const elmentInputText617 = document.getElementById('inputText617');elmentButtonCopy617.addEventListener('click', () => {const strInputTextValue = elmentInputText617.value;return navigator.clipboard.writeText(strInputTextValue);})</script>
</p><div class="sourceCode"><div style="color: #d4d4d4;background-color: #1e1e1e;font-family: Osaka-Mono,Menlo, Monaco, 'Courier New', monospace, Menlo, Monaco, 'Courier New', monospace;font-weight: normal;font-size: 16px;line-height: 18px;padding: 5px;"><div><span style="color: #6a9955;">#!/usr/bin/env osascript</span></div><div><span style="color: #6a9955;">----+----1----+----2----+-----3----+----4----+----5----+----6----+----7</span></div><div><span style="color: #6a9955;">#</span></div><div><span style="color: #6a9955;">#</span></div><div><span style="color: #6a9955;"># com.cocolog-nifty.quicktimer.icefloe</span></div><div><span style="color: #6a9955;">----+----1----+----2----+-----3----+----4----+----5----+----6----+----7</span></div><div><span style="color: #6a9955;">##自分環境がos12なので2.8にしているだけです</span></div><div><span style="color: #d4d4d4;">use AppleScript version </span><span style="color: #ce9178;">"2.8"</span></div><div><span style="color: #d4d4d4;">use framework </span><span style="color: #ce9178;">"Foundation"</span></div><div><span style="color: #d4d4d4;">use framework </span><span style="color: #ce9178;">"Appkit"</span></div><div><span style="color: #d4d4d4;">use framework </span><span style="color: #ce9178;">"UniformTypeIdentifiers"</span></div><div><span style="color: #d4d4d4;">use scripting additions</span></div><div><span style="color: #c586c0;">property</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">refMe</span><span style="color: #d4d4d4;"> : a reference to current application</span></div><div><span style="color: #6a9955;">##############################################</span></div><div><span style="color: #6a9955;">##設定項目</span></div><div><span style="color: #6a9955;">##############################################</span></div><div><span style="color: #6a9955;">##ディレクトリ名</span></div><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">strDirName</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> (</span><span style="color: #ce9178;">"Loginitems"</span><span style="color: #d4d4d4;">) as </span><span style="color: #4ec9b0;">text</span></div><div><span style="color: #6a9955;">###オールドユーザーはこちらかな？</span></div><div><span style="color: #6a9955;"># set strDirName to ("StartupItems") as text</span></div><div><span style="color: #6a9955;">###起動項目のバンドルID</span></div><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">strBundleID</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> (</span><span style="color: #ce9178;">"com.apple.FontBook"</span><span style="color: #d4d4d4;">) as </span><span style="color: #4ec9b0;">text</span></div><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">strAppFileName</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> (strBundleID &amp; </span><span style="color: #ce9178;">".app"</span><span style="color: #d4d4d4;">) as </span><span style="color: #4ec9b0;">text</span></div><div><span style="color: #6a9955;">###起動項目APPに隠すを入れるか？</span></div><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">boolSetHide</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #569cd6;">true</span><span style="color: #d4d4d4;"> as </span><span style="color: #4ec9b0;">boolean</span></div><br><div><span style="color: #6a9955;">#####################################</span></div><div><span style="color: #6a9955;">#####スクリプトメニューから実行させない</span></div><div><span style="color: #6a9955;">#####################################</span></div><div><span style="color: #c586c0;">tell</span><span style="color: #d4d4d4;"> current application</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">strName</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #dcdcaa;">name</span><span style="color: #d4d4d4;"> as </span><span style="color: #4ec9b0;">text</span></div><div><span style="color: #c586c0;">end tell</span></div><div><span style="color: #6a9955;">####スクリプトメニューから実行したら</span></div><div><span style="color: #c586c0;">if</span><span style="color: #d4d4d4;"> strName is </span><span style="color: #ce9178;">"osascript"</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">then</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">tell</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #4ec9b0;">application</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #ce9178;">"Finder"</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">aliasPathToMe</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #dcdcaa;">path to</span><span style="color: #d4d4d4;"> me as </span><span style="color: #4ec9b0;">alias</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c586c0;">tell</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #4ec9b0;">application</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #ce9178;">"Script Editor"</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #dcdcaa;">open</span><span style="color: #d4d4d4;"> aliasPathToMe</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c586c0;">end tell</span></div><div><span style="color: #d4d4d4;">    return </span><span style="color: #ce9178;">"中止しました"</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">end tell</span></div><div><span style="color: #c586c0;">else</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">tell</span><span style="color: #d4d4d4;"> current application</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #dcdcaa;">activate</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">end tell</span></div><div><span style="color: #c586c0;">end if</span></div><div><span style="color: #6a9955;">#####################################</span></div><div><span style="color: #6a9955;">##アプリケーション（起動項目用）を作成する</span></div><div><span style="color: #6a9955;">#####################################</span></div><br><div><span style="color: #6a9955;">###スクリプトパス</span></div><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">appFileManager</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> refMe's NSFileManager's defaultManager()</span></div><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">ocidURLsArray</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> (appFileManager's URLsForDirectory:(refMe's NSLibraryDirectory) inDomains:(refMe's NSUserDomainMask))</span></div><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">ocidLibraryDirPathURL</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> ocidURLsArray's firstObject()</span></div><div><span style="color: #6a9955;">###Loginitems</span></div><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">ocidLoginitemsDirPathURL</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> ocidLibraryDirPathURL's URLByAppendingPathComponent:(</span><span style="color: #ce9178;">"Loginitems"</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #6a9955;">###フォルダを作る</span></div><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">ocidAttrDict</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> refMe's NSMutableDictionary's alloc()'s initWithCapacity:</span><span style="color: #b5cea8;">0</span></div><div><span style="color: #d4d4d4;">ocidAttrDict's setValue:(</span><span style="color: #b5cea8;">448</span><span style="color: #d4d4d4;">) forKey:(refMe's NSFilePosixPermissions)</span></div><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">listBoolMakeDir</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> appFileManager's createDirectoryAtURL:(ocidLoginitemsDirPathURL) withIntermediateDirectories:</span><span style="color: #569cd6;">true</span><span style="color: #d4d4d4;"> attributes:(ocidAttrDict) |error|:(</span><span style="color: #569cd6;">reference</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #6a9955;">###保存先</span></div><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">ocidLoginitemsAppPathURL</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> ocidLoginitemsDirPathURL's URLByAppendingPathComponent:(strAppFileName)</span></div><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">aliasAppFilePath</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> (ocidLoginitemsAppPathURL's absoluteURL()) as «</span><span style="color: #4ec9b0;">class</span><span style="color: #d4d4d4;"> furl»</span></div><br><br><br><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">strScript</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> (</span><span style="color: #ce9178;">"#!/usr/bin/env osascript</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">----+----1----+----2----+-----3----+----4----+----5----+----6----+----7</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">#</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">(*</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">ログイン項目登録用</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">起動時に起動後『隠す』処理</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">ファイル＞書き出す…からアプリケーションに書き出し</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">ログイン項目に登録する</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">設定項目のバンドルIDは</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">https://github.com/force4u/AppleScript/blob/main/Script%20Menu/Developer/Get/getAppBundleID.applescript</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">を使って取得できます</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">*)</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">#com.cocolog-nifty.quicktimer.icefloe</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">----+----1----+----2----+-----3----+----4----+----5----+----6----+----7</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">use AppleScript version </span><span style="color: #d7ba7d;">\"</span><span style="color: #ce9178;">2.8</span><span style="color: #d7ba7d;">\"\n</span><span style="color: #ce9178;">use framework </span><span style="color: #d7ba7d;">\"</span><span style="color: #ce9178;">Foundation</span><span style="color: #d7ba7d;">\"\n</span><span style="color: #ce9178;">use scripting additions</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">###設定項目</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">set strBundleID to (</span><span style="color: #d7ba7d;">\"</span><span style="color: #ce9178;">"</span><span style="color: #d4d4d4;"> &amp; strBundleID &amp; </span><span style="color: #ce9178;">"</span><span style="color: #d7ba7d;">\"</span><span style="color: #ce9178;">) as text</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">###起動</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">tell application id strBundleID</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">launch</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">end tell</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">delay 3</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">###起動待ち　最大６０回</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">repeat 60 times</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">tell application id strBundleID</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">activate</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">set boolFrontMost to frontmost as boolean</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">end tell</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">if boolFrontMost is true then</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">exit repeat</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">else</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">delay 0.25</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">end if</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">end repeat</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">###名前の取得</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">tell application id strBundleID</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">set strAppName to name as text</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">end tell</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">###隠す処理</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">tell application </span><span style="color: #d7ba7d;">\"</span><span style="color: #ce9178;">System Events</span><span style="color: #d7ba7d;">\"\n</span><span style="color: #ce9178;">tell application process strAppName</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">set visible to false</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">end tell</span><span style="color: #d7ba7d;">\n</span><span style="color: #ce9178;">end tell"</span><span style="color: #d4d4d4;">) as </span><span style="color: #4ec9b0;">text</span></div><br><br><div><span style="color: #c586c0;">tell</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #4ec9b0;">application</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #ce9178;">"Script Editor"</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #dcdcaa;">make</span><span style="color: #d4d4d4;"> new </span><span style="color: #4ec9b0;">document</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #569cd6;">with</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #4ec9b0;">properties</span><span style="color: #d4d4d4;"> {contents:strScript}</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">tell</span><span style="color: #d4d4d4;"> front document</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #dcdcaa;">activate</span></div><div><span style="color: #d4d4d4;">    compile</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">end tell</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #dcdcaa;">save</span><span style="color: #d4d4d4;"> front </span><span style="color: #4ec9b0;">document</span><span style="color: #d4d4d4;"> as </span><span style="color: #ce9178;">"application"</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #569cd6;">in</span><span style="color: #d4d4d4;"> aliasAppFilePath </span><span style="color: #569cd6;">without</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #dcdcaa;">run</span><span style="color: #d4d4d4;"> only, startup screen and stay </span><span style="color: #dcdcaa;">open</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #dcdcaa;">close</span><span style="color: #d4d4d4;"> front </span><span style="color: #4ec9b0;">document</span><span style="color: #d4d4d4;"> saving </span><span style="color: #569cd6;">no</span></div><div><span style="color: #c586c0;">end tell</span></div><br><br><br><div><span style="color: #6a9955;">#####################################</span></div><div><span style="color: #6a9955;">##アプリケーション（起動項目用）を作成する</span></div><div><span style="color: #6a9955;">#####################################</span></div><br><div><span style="color: #6a9955;">###バンドル</span></div><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">ocidAppBundle</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> refMe's NSBundle's bundleWithURL:(ocidLoginitemsAppPathURL)</span></div><div><span style="color: #6a9955;">###基本情報を取得</span></div><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">ocidInfoDict</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> ocidAppBundle's infoDictionary</span></div><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">ocidBundleName</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> ocidInfoDict's valueForKey:(</span><span style="color: #ce9178;">"CFBundleName"</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">ocidBundleDisplayName</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> ocidInfoDict's valueForKey:(</span><span style="color: #ce9178;">"CFBundleDisplayName"</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #6a9955;">###ローカライズ名を取得する</span></div><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">ocidBundleDisplayNameLocalizable</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> ocidAppBundle's localizedStringForKey:(</span><span style="color: #ce9178;">"CFBundleDisplayName"</span><span style="color: #d4d4d4;">) value:(</span><span style="color: #ce9178;">""</span><span style="color: #d4d4d4;">) table:(</span><span style="color: #ce9178;">"InfoPlist"</span><span style="color: #d4d4d4;">)</span></div><div><span style="color: #c586c0;">if</span><span style="color: #d4d4d4;"> (ocidBundleDisplayNameLocalizable as </span><span style="color: #4ec9b0;">text</span><span style="color: #d4d4d4;">) is </span><span style="color: #ce9178;">"CFBundleDisplayName"</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">then</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">ocidBundleDisplayNameLocalizable</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> ocidBundleDisplayName</span></div><div><span style="color: #c586c0;">end if</span></div><div><span style="color: #c586c0;">if</span><span style="color: #d4d4d4;"> (ocidBundleDisplayNameLocalizable as </span><span style="color: #4ec9b0;">text</span><span style="color: #d4d4d4;">) is </span><span style="color: #ce9178;">""</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">then</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">ocidBundleDisplayNameLocalizable</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> ocidBundleName</span></div><div><span style="color: #c586c0;">end if</span></div><br><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">strAppName</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> ocidBundleDisplayNameLocalizable as </span><span style="color: #4ec9b0;">text</span></div><div><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">strAppPath</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> (ocidLoginitemsAppPathURL's |path|()) as </span><span style="color: #4ec9b0;">text</span></div><div><span style="color: #dcdcaa;">log</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #ce9178;">"strAppName:"</span><span style="color: #d4d4d4;"> &amp; strAppName</span></div><br><div><span style="color: #c586c0;">tell</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #4ec9b0;">application</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #ce9178;">"System Events"</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">if</span><span style="color: #d4d4d4;"> boolSetHide is </span><span style="color: #569cd6;">true</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">then</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">recordProperties</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> {name:strAppName, path:strAppPath, class:login </span><span style="color: #dcdcaa;">item</span><span style="color: #d4d4d4;">, kind:</span><span style="color: #ce9178;">"アプリケーション"</span><span style="color: #d4d4d4;">, hidden:</span><span style="color: #569cd6;">true</span><span style="color: #d4d4d4;">}</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">else</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">recordProperties</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> {name:strAppName, path:strAppPath, class:login </span><span style="color: #dcdcaa;">item</span><span style="color: #d4d4d4;">, kind:</span><span style="color: #ce9178;">"アプリケーション"</span><span style="color: #d4d4d4;">, hidden:</span><span style="color: #569cd6;">false</span><span style="color: #d4d4d4;">}</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">end if</span></div><div><span style="color: #c586c0;">end tell</span></div><br><div><span style="color: #6a9955;">####ログインアイテム 設定開始時</span></div><div><span style="color: #dcdcaa;">log</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #ce9178;">"設定前："</span></div><div><span style="color: #c586c0;">tell</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #4ec9b0;">application</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #ce9178;">"System Events"</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">listLoginItem</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> every login </span><span style="color: #dcdcaa;">item</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">listOutPut</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> {} as </span><span style="color: #4ec9b0;">list</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">repeat</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">with</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">itemLoginItem</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">in</span><span style="color: #d4d4d4;"> listLoginItem</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c586c0;">tell</span><span style="color: #d4d4d4;"> itemLoginItem</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">recordProperties</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #4ec9b0;">properties</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #569cd6;">set</span><span style="color: #d4d4d4;"> end </span><span style="color: #569cd6;">of</span><span style="color: #d4d4d4;"> listOutPut to recordProperties</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c586c0;">end tell</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">end repeat</span></div><div><span style="color: #c586c0;">end tell</span></div><br><div><span style="color: #6a9955;">####ログインアイテム 設定</span></div><div><span style="color: #dcdcaa;">log</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #ce9178;">"設定："</span></div><div><span style="color: #c586c0;">tell</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #4ec9b0;">application</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #ce9178;">"System Events"</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #dcdcaa;">make</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #4ec9b0;">login item</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #569cd6;">at</span><span style="color: #d4d4d4;"> end with </span><span style="color: #4ec9b0;">properties</span><span style="color: #d4d4d4;"> recordProperties</span></div><div><span style="color: #c586c0;">end tell</span></div><br><br><div><span style="color: #6a9955;">####ログインアイテム 設定後</span></div><div><span style="color: #dcdcaa;">log</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #ce9178;">"設定後："</span></div><div><span style="color: #c586c0;">tell</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #4ec9b0;">application</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #ce9178;">"System Events"</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">listLoginItem</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> every login </span><span style="color: #dcdcaa;">item</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">listOutPut</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;"> {} as </span><span style="color: #4ec9b0;">list</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">repeat</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">with</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">itemLoginItem</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">in</span><span style="color: #d4d4d4;"> listLoginItem</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c586c0;">tell</span><span style="color: #d4d4d4;"> itemLoginItem</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c586c0;">set</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #9cdcfe;">recordProperties</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #c586c0;">to</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #4ec9b0;">properties</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #569cd6;">set</span><span style="color: #d4d4d4;"> end </span><span style="color: #569cd6;">of</span><span style="color: #d4d4d4;"> listOutPut to recordProperties</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c586c0;">end tell</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #c586c0;">end repeat</span></div><div><span style="color: #c586c0;">end tell</span></div><br><div><span style="color: #6a9955;">###ログイン項目を開く</span></div><div><span style="color: #c586c0;">tell</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #4ec9b0;">application</span><span style="color: #d4d4d4;"> id </span><span style="color: #ce9178;">"com.apple.systempreferences"</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #dcdcaa;">launch</span></div><div><span style="color: #d4d4d4;">&nbsp;&nbsp;</span><span style="color: #dcdcaa;">activate</span></div><div><span style="color: #d4d4d4;">  reveal anchor </span><span style="color: #ce9178;">"startupItemsPref"</span><span style="color: #d4d4d4;">&nbsp;</span><span style="color: #569cd6;">of</span><span style="color: #d4d4d4;"> pane id </span><span style="color: #ce9178;">"com.apple.LoginItems-Settings.extension"</span></div><div><span style="color: #c586c0;">end tell</span></div></div></div><hr>
